# КАНОН MINDFORGE STUDIO

## Цель проекта
Генерация профессиональных портретов для коммерческой продажи на маркетплейсах (Adobe Stock, Shutterstock, Dreamstime).

## Принципы работы

### Стабильность > Качество
- На текущем железе (RTX 3060 12GB) стабильность генерации важнее максимального разрешения
- При выборе между "падение на 20-й генерации" и "стабильные 50 генераций в 320x320"  выбираем стабильность
- Качество можно улучшить позже (апскейл, ретушь в постобработке)

### Паузы > Скорость
- Минимальная пауза между генерациями: 2 секунды
- Пауза даёт время на остывание видеокарты до <78C
- Скорость генерации 2.5-3.5 сек/изображение  приемлема для массовой генерации

### Простота > Сложность
- Избегаем тяжёлых моделей (SDXL) в массовой генерации
- Избегаем множественных LoRA одновременно
- Избегаем сложных контрольных сетей (ControlNet) в батч-режиме

## Ограничения железа (RTX 3060 12GB)

### Безопасные параметры для 50+ генераций подряд
| Параметр | Значение | Комментарий |
|----------|----------|-------------|
| Разрешение | 320320 | Максимальное для 50+ генераций |
| Шаги | 8 | Оптимальный баланс скорость/качество |
| CFG | 5.0 | Стабильная генерация без артефактов |
| Сэмплер | euler | Минимальная нагрузка на память |
| Пауза | 2 сек | Обязательная для остывания |
| Температура | <78C | Критический лимит  выше = падение |

### Таблица параметров под задачи
| Тип задачи | Разрешение | Шаги | Пауза | Макс. генераций |
|------------|------------|------|-------|-----------------|
| Мини-превью | 256256 | 6 | 1.5 сек | 100+ |
| Стандартный портрет | 320320 | 8 | 2.0 сек | 50 |
| Повышенное качество | 384384 | 10 | 2.5 сек | 20 |
| Максимальное качество | 448448 | 12 | 3.0 сек | 10 |
| Экспериментальное | 512512 | 15 | 4.0 сек | 5 |

### Правила реагирования на проблемы
- При температуре >80C: автоматически снижать разрешение на 1 ступень
- При падении на генерации #N: запоминать параметры и предлагать снижение
- При ошибке "CUDA out of memory": уменьшать разрешение до 256256

## Правила коммитов в GitHub

### Коммитим 
- Код (Python, скрипты, конфиги)
- Документация (md, yaml, json схемы)
- Тесты (pytest, smoke tests)
- 520 approved изображений как демо (только отобранные)

### НЕ коммитим 
- .env, токены, ключи доступа
- Модели (.safetensors, .gguf, .bin)
- Большие выходные папки "всё подряд"
- Временные файлы, кэш

### .gitignore рекомендации
env
pycache/
.pyc
.log
sd/outputs/**/
!sd/outputs/**/approved/*
llm_baza/ai_models/**
G:/1/AI/**

## Метрики успеха
- 50 генераций подряд без падений =  Стабильность достигнута
- Температура <78C во время генерации =  Безопасный режим
- Время генерации 2.5-4.0 сек/изображение =  Приемлемая скорость
- Идеальные пропорции лиц (без асимметрии) =  Качество для продажи

## Дорожная карта
1. Этап 1: Движок генерации как библиотека (адаптер + pipeline)
2. Этап 2: Формат заказа (YAML + валидатор)
3. Этап 3: Накопление + одобрение (система approve/reject)
4. Этап 4: Telegram как пульт управления
5. Этап 5: LLM ArtDirector (v1)
6. Этап 6: GitHub-витрина и доверие
7. Этап 7: Сайт-заказчик (MVP)
8. Этап 8: Медиа-расширения (аудио/видео)
